<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Equip Booking System</title>
<link href="https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&display=swap" rel="stylesheet">
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
<style>
/* ═══════════════════════════════════════════════
   TOKENS & RESET
═══════════════════════════════════════════════ */
:root {
  --navy:        #0d2136;
  --navy-light:  #1a3550;
  --gold:        #a8935a;
  --soft-gold:   #d6cab0;
  --beige:       #d8d0c6;
  --lt-beige:    #e6e1da;
  --cream:       #f4f2ef;
  --grey:        #d3d6d9;
  --blue-grey:   #8a949e;
  --green:       #81845a;
  --dk-green:    #2f3527;
  --teal:        #004551;
  --dk-teal:     #002937;
  --plum:        #7e2138;
  --dk-plum:     #512137;
  --white:       #ffffff;
  --danger:      #c0392b;
  --shadow-sm:   0 2px 12px rgba(13,33,54,.08);
  --shadow-md:   0 8px 32px rgba(13,33,54,.14);
  --shadow-lg:   0 24px 60px rgba(13,33,54,.22);
}
*{box-sizing:border-box;margin:0;padding:0;}
html,body{height:100%;overflow:hidden;font-family:'Libre Franklin',sans-serif;color:var(--navy);background:var(--cream);}
h1,h2,h3,h4,h5,.serif{font-family:'Georgia',serif;font-weight:normal;}
button{cursor:pointer;font-family:'Libre Franklin',sans-serif;transition:all .18s ease;}
button:active{transform:scale(.97);}
input,select,textarea{font-family:'Libre Franklin',sans-serif;color:var(--navy);}
::-webkit-scrollbar{width:5px;height:5px;}
::-webkit-scrollbar-track{background:var(--lt-beige);}
::-webkit-scrollbar-thumb{background:var(--soft-gold);border-radius:4px;}

/* ─── SCREEN MANAGEMENT + ANIMATIONS ─── */
.screen{display:none;position:fixed;inset:0;z-index:100;}
.screen.active{display:flex;}

/* Page transition system */
.screen.slide-in-right { animation: slideInRight 0.45s cubic-bezier(.22,.68,0,1.2) forwards; }
.screen.slide-in-left  { animation: slideInLeft  0.45s cubic-bezier(.22,.68,0,1.2) forwards; }
.screen.slide-out-left { animation: slideOutLeft 0.35s cubic-bezier(.4,0,1,1) forwards; }
.screen.slide-out-right{ animation: slideOutRight 0.35s cubic-bezier(.4,0,1,1) forwards; }
.screen.fade-up        { animation: fadeUp 0.5s cubic-bezier(.22,.68,0,1.1) forwards; }

@keyframes slideInRight { from{opacity:0;transform:translateX(60px)} to{opacity:1;transform:translateX(0)} }
@keyframes slideInLeft  { from{opacity:0;transform:translateX(-60px)} to{opacity:1;transform:translateX(0)} }
@keyframes slideOutLeft { from{opacity:1;transform:translateX(0)} to{opacity:0;transform:translateX(-60px)} }
@keyframes slideOutRight{ from{opacity:1;transform:translateX(0)} to{opacity:0;transform:translateX(60px)} }
@keyframes fadeUp       { from{opacity:0;transform:translateY(40px)} to{opacity:1;transform:translateY(0)} }

#loading-screen{background:linear-gradient(135deg,var(--navy),var(--dk-teal));align-items:center;justify-content:center;flex-direction:column;gap:20px;}
.spinner{width:44px;height:44px;border:3px solid rgba(168,147,90,.3);border-top-color:var(--gold);border-radius:50%;animation:spin 1s linear infinite;}
@keyframes spin{to{transform:rotate(360deg)}}
.loading-text{color:var(--soft-gold);font-size:13px;letter-spacing:3px;text-transform:uppercase;}

/* Button ripple */
.btn-ripple{position:relative;overflow:hidden;}
.btn-ripple::after{content:'';position:absolute;width:100px;height:100px;background:rgba(255,255,255,.25);border-radius:50%;transform:scale(0);opacity:1;pointer-events:none;}
.btn-ripple.rippling::after{animation:ripple .5s ease-out forwards;}
@keyframes ripple{to{transform:scale(4);opacity:0;}}

/* Panel switch animation */
.panel-fade { animation: panelFade 0.4s cubic-bezier(.22,.68,0,1.1); }
@keyframes panelFade { from{opacity:0;transform:translateY(12px)} to{opacity:1;transform:translateY(0)} }

/* Modal open/close - display controlled by JS */
.overlay{position:fixed;inset:0;background:rgba(13,33,54,.6);backdrop-filter:blur(6px);z-index:500;display:none;align-items:center;justify-content:center;padding:16px;
  opacity:0;transition:opacity .35s ease;}
.overlay.open{opacity:1;}
.overlay .modal{transform:translateY(24px) scale(.97);transition:transform .4s cubic-bezier(.22,.68,0,1.2);}
.overlay.open .modal{transform:translateY(0) scale(1);}

/* Calendar chip entrance */
.bk-chip { animation: chipIn .2s ease; }
@keyframes chipIn { from{opacity:0;transform:scaleY(.7)} to{opacity:1;transform:scaleY(1)} }

/* Notify animation */
@keyframes notifIn  { from{opacity:0;transform:translateY(20px)} to{opacity:1;transform:translateY(0)} }
@keyframes notifOut { from{opacity:1;transform:translateY(0)} to{opacity:0;transform:translateY(20px)} }

/* Month cell hover */
.month-cell { transition: background .2s ease; }
.mini-cal   { transition: all .25s cubic-bezier(.22,.68,0,1.2); }
.user-option{ transition: all .2s cubic-bezier(.22,.68,0,1.2); }
.portal-card{ transition: all .35s cubic-bezier(.22,.68,0,1.2); }

/* Nav item transitions */
.nav-item { transition: all .2s cubic-bezier(.22,.68,0,1.2); }
.res-tab  { transition: all .22s ease; }
.view-tab { transition: all .22s ease; }

/* ─── PORTAL SELECTION ─── */
#portal-screen{background:linear-gradient(145deg,var(--navy) 0%,var(--dk-teal) 60%,var(--dk-plum) 100%);align-items:center;justify-content:center;flex-direction:column;overflow-y:auto;}
.portal-deco{position:absolute;border-radius:50%;border:1px solid rgba(168,147,90,.1);}
.portal-deco-1{width:600px;height:600px;top:-200px;right:-200px;}
.portal-deco-2{width:400px;height:400px;bottom:-150px;left:-100px;}
.portal-deco-3{width:200px;height:200px;top:30%;left:5%;}
.portal-inner{text-align:center;width:90%;max-width:860px;position:relative;z-index:1;padding:40px 0;}
.portal-logo-wrap{margin-bottom:32px;}
.portal-logo{width:180px;height:180px;border-radius:36px;background:linear-gradient(135deg,var(--gold),var(--soft-gold));margin:0 auto;display:flex;align-items:center;justify-content:center;box-shadow:0 28px 70px rgba(0,0,0,.4),0 0 0 2px rgba(168,147,90,.5);}
.portal-logo svg{width:100px;height:100px;}
.portal-divider{display:flex;align-items:center;justify-content:center;gap:16px;margin-bottom:10px;}
.portal-divider-line{height:1px;width:50px;background:linear-gradient(to right,transparent,var(--gold));}
.portal-divider-line.right{background:linear-gradient(to left,transparent,var(--gold));}
.portal-kicker{color:var(--gold);font-size:11px;letter-spacing:4px;text-transform:uppercase;font-weight:500;}
.portal-title{color:var(--white);font-size:clamp(28px,4vw,44px);margin-bottom:8px;letter-spacing:-.5px;}
.portal-sub{color:var(--blue-grey);font-size:14px;margin-bottom:48px;font-weight:300;}
.portal-cards{display:grid;grid-template-columns:1fr 1fr;gap:20px;}
@media(max-width:600px){.portal-cards{grid-template-columns:1fr;}}
.portal-card{background:rgba(255,255,255,.06);backdrop-filter:blur(12px);border:1px solid rgba(168,147,90,.25);border-radius:20px;padding:40px 28px;transition:all .3s ease;text-align:left;cursor:pointer;}
.portal-card:hover{background:rgba(168,147,90,.12);border-color:var(--gold);transform:translateY(-4px);box-shadow:0 20px 50px rgba(0,0,0,.3);}
.portal-card-icon{width:56px;height:56px;border-radius:14px;display:flex;align-items:center;justify-content:center;margin-bottom:20px;font-size:22px;}
.portal-card-icon.admin{background:linear-gradient(135deg,var(--gold),var(--soft-gold));}
.portal-card-icon.user{background:linear-gradient(135deg,var(--teal),var(--dk-teal));}
.portal-card h2{color:var(--white);font-size:22px;margin-bottom:8px;}
.portal-card p{color:var(--blue-grey);font-size:13px;line-height:1.6;}
.portal-footer{color:rgba(138,148,158,.4);font-size:11px;margin-top:40px;letter-spacing:.5px;}

.modal-screen{background:rgba(13,33,54,.9);backdrop-filter:blur(8px);align-items:center;justify-content:center;z-index:200;}
.modal-box{background:var(--white);border-radius:24px;width:90%;max-width:480px;padding:40px;border:1px solid var(--gold);box-shadow:var(--shadow-lg);max-height:90vh;overflow-y:auto;position:relative;}
.modal-box.wide{max-width:640px;}
.modal-back{position:absolute;top:16px;left:16px;background:transparent;border:1px solid var(--grey);color:var(--blue-grey);border-radius:8px;padding:7px 14px;font-size:12px;}
.modal-back:hover{background:var(--cream);color:var(--navy);}
.modal-logo{display:flex;justify-content:center;margin-bottom:24px;}
.modal-box h2{text-align:center;color:var(--navy);font-size:26px;margin-bottom:6px;}
.modal-box .subtitle{text-align:center;color:var(--blue-grey);font-size:13px;margin-bottom:32px;}

/* ─── USER SELECTION ─── */
.user-list{max-height:420px;overflow-y:auto;}
.dept-group{margin-bottom:20px;}
.dept-label{background:var(--navy);color:var(--gold);padding:8px 14px;border-radius:8px;font-size:11px;letter-spacing:2px;text-transform:uppercase;font-weight:600;margin-bottom:8px;}
.user-option{display:flex;align-items:center;gap:14px;padding:14px 16px;background:var(--cream);border:2px solid transparent;border-radius:12px;margin-bottom:6px;cursor:pointer;transition:all .2s ease;}
.user-option:hover{border-color:var(--gold);background:var(--white);transform:translateX(4px);}
.u-avatar{width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg,var(--teal),var(--dk-teal));color:var(--white);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:13px;flex-shrink:0;}
.u-name{font-weight:600;color:var(--navy);font-size:14px;}
.u-dept{font-size:12px;color:var(--blue-grey);}

/* ─── MAIN APP ─── */
#app{display:none;flex-direction:row;height:100vh;}
#app.active{display:flex;}

/* ─── SIDEBAR ─── */
.sidebar{width:240px;background:var(--navy);flex-shrink:0;display:flex;flex-direction:column;border-right:1px solid rgba(168,147,90,.18);}

/* Logo header — centered stacked */
.sidebar-logo{
  padding:24px 18px 20px;
  border-bottom:1px solid rgba(168,147,90,.14);
  display:flex;flex-direction:column;align-items:center;gap:14px;text-align:center;
}
.sidebar-logo-icon{
  width:80px;height:80px;border-radius:20px;
  background:linear-gradient(135deg,var(--gold),var(--soft-gold));
  display:flex;align-items:center;justify-content:center;flex-shrink:0;
  box-shadow:0 8px 28px rgba(168,147,90,.35);
}
.sidebar-logo-icon img{width:54px;height:54px;object-fit:contain;}
.sidebar-brand{}
.sidebar-brand h1{
  color:var(--white);font-family:'Georgia',serif;font-size:16px;
  font-weight:normal;letter-spacing:.3px;line-height:1.2;margin-bottom:3px;
}
.sidebar-brand span{color:var(--gold);font-size:10px;letter-spacing:3px;text-transform:uppercase;font-weight:500;}

/* User card */
.sidebar-user{
  padding:14px 16px;
  border-bottom:1px solid rgba(255,255,255,.06);
  display:flex;align-items:center;gap:12px;
  background:rgba(255,255,255,.03);
}
.sidebar-avatar{
  width:38px;height:38px;border-radius:50%;
  background:linear-gradient(135deg,var(--teal),var(--dk-teal));
  color:var(--white);display:flex;align-items:center;justify-content:center;
  font-weight:700;font-size:13px;flex-shrink:0;
  border:2px solid rgba(168,147,90,.3);
}
.sidebar-avatar.admin-av{background:linear-gradient(135deg,var(--gold),var(--soft-gold));color:var(--navy);}
.sidebar-user-info{overflow:hidden;flex:1;}
.sidebar-user-name{color:var(--white);font-size:13px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;line-height:1.3;}
.sidebar-user-role{color:var(--blue-grey);font-size:11px;margin-top:1px;}

.sidebar-nav{flex:1;padding:16px 12px;}
.nav-item{display:flex;align-items:center;gap:10px;padding:10px 14px;border-radius:9px;color:var(--blue-grey);font-size:13px;font-weight:400;border:1px solid transparent;background:transparent;width:100%;text-align:left;margin-bottom:3px;}
.nav-item:hover{background:rgba(255,255,255,.06);color:var(--soft-gold);}
.nav-item.active{background:rgba(168,147,90,.16);border-color:rgba(168,147,90,.28);color:var(--soft-gold);font-weight:600;}
.nav-item .nav-icon{font-size:16px;width:20px;text-align:center;}

.sidebar-resources{margin:0 12px 12px;background:rgba(168,147,90,.07);border-radius:10px;padding:12px 14px;}
.sidebar-resources .sr-label{color:var(--gold);font-size:10px;letter-spacing:2px;text-transform:uppercase;margin-bottom:8px;font-weight:600;}
.sr-item{display:flex;align-items:center;gap:8px;color:var(--blue-grey);font-size:12px;margin-bottom:5px;}
.sr-dot{width:7px;height:7px;border-radius:2px;flex-shrink:0;}
.sidebar-bottom{padding:10px 12px 14px;}
.sidebar-live{display:flex;align-items:center;gap:6px;padding:7px 12px;color:var(--green);font-size:11px;font-weight:600;margin-bottom:6px;letter-spacing:.5px;}
.live-dot{width:7px;height:7px;border-radius:50%;background:var(--green);animation:pulse 2s infinite;flex-shrink:0;}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.35}}
.btn-signout{width:100%;padding:9px;background:transparent;border:1px solid rgba(255,255,255,.1);border-radius:9px;color:var(--blue-grey);font-size:12px;display:flex;align-items:center;justify-content:center;gap:6px;}
.btn-signout:hover{background:rgba(255,255,255,.06);color:var(--soft-gold);border-color:rgba(168,147,90,.3);}

/* ─── MAIN CONTENT ─── */
.main-content{flex:1;display:flex;flex-direction:column;overflow:hidden;}

/* ─── TOP BAR ─── */
.topbar{padding:14px 28px;background:var(--white);border-bottom:1px solid var(--grey);display:flex;align-items:center;gap:16px;flex-shrink:0;flex-wrap:wrap;}
.resource-tabs{display:flex;gap:4px;background:var(--cream);border-radius:10px;padding:4px;}
.res-tab{padding:8px 18px;border-radius:7px;border:none;background:transparent;color:var(--blue-grey);font-size:13px;font-weight:500;display:flex;align-items:center;gap:7px;}
.res-tab.active{background:var(--navy);color:var(--white);}
.res-tab .res-dot{width:7px;height:7px;border-radius:2px;display:inline-block;}
.topbar-nav{display:flex;align-items:center;gap:8px;margin-left:auto;}
.btn-today{padding:7px 16px;background:var(--cream);border:1px solid var(--grey);border-radius:8px;font-size:12px;color:var(--navy);}
.btn-today:hover{background:var(--lt-beige);}
.btn-nav{width:32px;height:32px;background:var(--cream);border:1px solid var(--grey);border-radius:8px;font-size:16px;color:var(--navy);display:flex;align-items:center;justify-content:center;}
.btn-nav:hover{background:var(--lt-beige);}
.topbar-title{font-family:'Georgia',serif;font-size:16px;color:var(--navy);min-width:210px;text-align:center;}
.view-tabs{display:flex;gap:3px;background:var(--cream);border-radius:10px;padding:4px;}
.view-tab{padding:7px 14px;border-radius:7px;border:none;background:transparent;color:var(--blue-grey);font-size:12px;font-weight:500;text-transform:capitalize;}
.view-tab.active{background:var(--navy);color:var(--white);font-weight:600;}
.btn-book{padding:9px 20px;background:linear-gradient(135deg,var(--gold),var(--soft-gold));border:none;border-radius:9px;color:var(--navy);font-size:13px;font-weight:700;flex-shrink:0;}
.btn-book:hover{filter:brightness(1.06);}

/* ─── CALENDAR AREA ─── */
.calendar-wrap{flex:1;overflow:auto;padding:20px 28px;}

/* ─── DAY / WEEK VIEWS ─── */
.time-grid{display:grid;border-radius:16px;overflow:hidden;border:1px solid var(--grey);background:var(--white);}
.tg-header{display:grid;background:var(--navy);border-bottom:2px solid var(--gold);font-size:11px;color:var(--soft-gold);letter-spacing:1.5px;text-transform:uppercase;}
.tg-header .th-time{padding:12px 10px;border-right:1px solid rgba(255,255,255,.08);}
.tg-header .th-day{padding:12px 8px;text-align:center;border-right:1px solid rgba(255,255,255,.08);}
.th-day-num{color:var(--white);font-family:'Georgia',serif;font-size:20px;line-height:1;}
.th-day-today .th-day-num{color:var(--gold);}
.th-today-dot{width:4px;height:4px;border-radius:50%;background:var(--gold);margin:4px auto 0;}
.tg-body{display:grid;position:relative;}
.tg-row{display:grid;border-bottom:1px solid var(--lt-beige);}
.time-cell{padding:4px 10px 0;text-align:right;color:var(--blue-grey);font-size:10px;border-right:1px solid var(--grey);font-weight:500;}
.day-cell{border-right:1px solid var(--lt-beige);position:relative;cursor:pointer;}
.day-cell:hover{background:rgba(168,147,90,.04);}
.day-cell.today-col{background:rgba(168,147,90,.03);}
/* Booking chip in time grid */
.bk-chip{position:absolute;left:3px;right:3px;border-radius:6px;padding:4px 7px;overflow:hidden;z-index:5;cursor:pointer;transition:filter .15s;}
.bk-chip:hover{filter:brightness(1.1);}
.bk-chip.boardroom{background:linear-gradient(135deg,var(--teal),#006375);}
.bk-chip.car{background:linear-gradient(135deg,var(--dk-plum),var(--plum));}
.bk-title{color:var(--white);font-size:11px;font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.bk-meta{color:rgba(255,255,255,.75);font-size:10px;margin-top:1px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}

/* ─── MONTH VIEW ─── */
.month-grid{border-radius:16px;overflow:hidden;border:1px solid var(--grey);background:var(--white);}
.month-header-row{display:grid;grid-template-columns:repeat(7,1fr);background:var(--navy);border-bottom:2px solid var(--gold);}
.month-header-row .mhc{padding:12px 8px;text-align:center;color:var(--soft-gold);font-size:11px;letter-spacing:2px;text-transform:uppercase;}
.month-body{display:grid;grid-template-columns:repeat(7,1fr);}
.month-cell{min-height:110px;border-right:1px solid var(--lt-beige);border-bottom:1px solid var(--lt-beige);padding:8px 6px;cursor:pointer;transition:background .15s;}
.month-cell:hover{background:var(--cream);}
.month-cell.other-month{background:var(--cream);opacity:.55;}
.month-cell.today{background:rgba(168,147,90,.07);}
.mc-num{width:26px;height:26px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:13px;margin:0 auto 5px auto;font-weight:400;}
.mc-num.today-num{background:var(--gold);color:var(--white);font-weight:700;}
.mc-chip{border-radius:4px;padding:3px 6px;margin-bottom:2px;font-size:10px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;cursor:pointer;}
.mc-chip.boardroom{background:rgba(0,69,81,.15);color:var(--teal);}
.mc-chip.car{background:rgba(126,33,56,.15);color:var(--plum);}
.mc-more{font-size:10px;color:var(--blue-grey);padding-left:4px;}

/* ─── YEAR VIEW ─── */
.year-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;}
.mini-cal{background:var(--white);border-radius:12px;border:1px solid var(--grey);overflow:hidden;cursor:pointer;transition:all .2s;}
.mini-cal:hover{border-color:var(--gold);transform:translateY(-2px);box-shadow:var(--shadow-md);}
.mini-cal-hdr{background:var(--navy);padding:10px 12px;color:var(--white);font-family:'Georgia',serif;font-size:13px;display:flex;justify-content:space-between;align-items:center;}
.mini-cal-hdr .bk-count{background:var(--gold);color:var(--navy);font-size:9px;font-weight:700;border-radius:10px;padding:1px 6px;font-family:'Libre Franklin',sans-serif;}
.mini-cal-body{padding:6px 4px;}
.mini-days-hdr{display:grid;grid-template-columns:repeat(7,1fr);margin-bottom:3px;}
.mini-days-hdr span{text-align:center;font-size:8px;color:var(--blue-grey);padding:2px 0;}
.mini-days-body{display:grid;grid-template-columns:repeat(7,1fr);}
.mini-day{text-align:center;font-size:9px;padding:2px 0;border-radius:50%;margin:1px auto;width:18px;height:18px;display:flex;align-items:center;justify-content:center;}
.mini-day.has-bk{background:rgba(0,69,81,.15);color:var(--teal);font-weight:700;}
.mini-day.today-mini{background:var(--gold);color:var(--white);font-weight:700;}

/* ─── ADMIN PANEL ─── */
.admin-wrap{flex:1;overflow:hidden;display:flex;flex-direction:column;}
.admin-topbar{padding:16px 28px 0;background:var(--white);border-bottom:1px solid var(--grey);flex-shrink:0;}
.admin-topbar h2{font-family:'Georgia',serif;color:var(--navy);font-size:22px;margin-bott
